# Discord Bot - Watermark Management Bot

## 概要
このDiscord Botは、各チャンネルごとにウォーターマークを設定し、画像に透かしを自動適用する機能を提供します。

### 主な機能
1. **ウォーターマークのアップロード**
   - チャンネルごとに透かし画像を設定できます。
2. **現在のウォーターマークを表示**
   - 現在設定されている透かし画像を確認できます。
3. **ウォーターマークの削除**
   - 設定済みの透かし画像をクリアします。
4. **画像への透かし適用**
   - チャンネルに投稿された画像に自動で透かしを適用し、返信として投稿します。

---

## コマンド一覧

### プレフィックスコマンド
Botのコマンドは、環境変数`COMMAND_PREFIX`で指定されたプレフィックスを使って呼び出します。

#### 基本コマンド
- **`/hello`**
  - Botが挨拶を返します。

#### ウォーターマーク関連
- **`/upload_watermark` / `/uw` / `/wm_set`**
  - 現在のチャンネルに透かし画像を設定します。
  - **使い方**:
    1. コマンドと一緒に画像を添付して送信します。
    2. 設定された画像は現在のチャンネル専用の透かしとして保存されます。
    3. 例: `/upload_watermark`（画像を添付）

- **`/show_watermark` / `/sw` / `/wm_check`**
  - 現在のチャンネルで設定されている透かし画像と透過度を表示します。
  - **表示例**:
    - 透過度: `50%` (デフォルト`15%`)
    - 設定された透かし画像を送信します。

- **`/clear_watermark` / `/cw` / `/wm_clear`**
  - 現在のチャンネルで設定されている透かし画像を削除します。

- **`/set_transparency` / `/settp` / `/wm_settp`**
  - 現在のチャンネルの透過度を設定します。
  - **使い方**:
    1. コマンドと一緒に透過度（1～100の半角整数）を指定します。
    2. 指定した透過度は、透かし画像に適用されます。
    3. 例: `/settp 30`（透過度30%に設定）


### 自動動作
チャンネルに画像が投稿されると、設定された透かし画像を適用した画像が返信として投稿されます。

---

## 環境変数
- **`DISCORD_TOKEN`**: Discord Botのトークン。
- **`COMMAND_PREFIX`**: Botのコマンドプレフィックス（例: `/`）。
- **`BASE_DIR`**: Botが設定データや一時ファイルを保存するディレクトリ。

---

## 使用方法

1. `.env`ファイルを作成し、以下のように記述します。

```env
DISCORD_TOKEN=your_discord_bot_token
COMMAND_PREFIX=/
BASE_DIR=./data
```

2. 必要なPythonライブラリをインストールします。

```bash
pip install -r requirements.txt
```

3. Botを起動します。

```bash
python bot.py
```

4. BotをDiscordサーバーに招待し、コマンドを使用して透かしを管理します。

---

## 今後の課題

1. **メッセージの多言語化**
   - 少なくとも英語と日本語に対応し、ユーザーが使用する言語に合わせたメッセージを表示する。

2. **自然な言語設定の選択**
   - Discordユーザーの設定言語を読み取り、適切な言語でメッセージを表示する仕組みの導入。

3. **メッセージのサジェスト機能**
   - スラッシュコマンドや入力補完を活用し、ユーザーが利用可能なコマンドやオプションを簡単に選択できるようにする。

---

## 既知の問題

1. **透過情報を持つgif形式への対応**
   - 残像が残る問題があるため、`src/utils/watermark_processor.py`の更新必要

---

## ライセンス
このBotはMITライセンスの下で公開されています。

